const e=128,t=(()=>{let t=1;for(;Number.isSafeInteger(t*e);)t*=e;return t})();function r(e){if(!Number.isSafeInteger(e)||e<0)throw new TypeError(`invalid uvarint: ${e}`)}function n(t){r(t);let n=1;for(;t>=e;++n)t=Math.floor(t/e);return n}function s(r,n=0){let s=0;for(let i=1;;i*=e){if(n>=r.length)throw new RangeError("buffer overflow");let o=r[n++];if(s+=(127&o)*i,o<e)break;if(i==t)throw new RangeError("uvarint overflow")}return[s,n]}function i(t,n,s=0){for(r(n);!(n<e);)t[s++]=127&n|e,n=Math.floor(n/e);return t[s++]=n,s}var o=Object.freeze({__proto__:null,MAX:t,read:s,sizeof:n,write:i});class h{constructor(e){this.chars=[...e],this.map=new Map(this.chars.map(((e,t)=>[e,t])))}indexOf(e){let t=this.map.get(e);if(!Number.isInteger(t))throw new TypeError(`invalid digit "${e}"`);return t}encode(e){return Array.from(e,(e=>this.chars[e])).join("")}}class a{constructor(e){this.table=new h(e);let t=this.table.chars.length;if(this.bits=Math.log2(t),t<2||!Number.isInteger(this.bits))throw new TypeError;this.table.chars.push("=")}decode(e){let{table:t,bits:r}=this,n=e.length,s=0,i=0,o=0;for(;n&&"="==e[n-1];)--n;let h=new Uint8Array(n*r>>3);for(let a=0;a<n;a++)i=i<<r|t.indexOf(e[a]),o+=r,o>=8&&(h[s++]=i>>(o-=8)&255);if(i<<8-o&255)throw new Error("invalid");return h}encode(e,t){let{table:r,bits:n}=this,s=(1<<n)-1,i=0,o=0,h=[],a=e.length;for(let t=0;t<a;t++)for(i=i<<8|e[t],o+=8;o>=n;)h.push(i>>(o-=n)&s);for(o&&h.push(i<<n-o&s);t&&h.length*n&7;)h.push(s+1);return r.encode(h)}}class c{constructor(e){this.table=new h(e)}decode(e){let{table:t}=this,r=t.chars.length,n=e.length,s=new Uint8Array(n),i=0;for(let n of e){let e=t.indexOf(n);for(let t=0;t<i;t++)e+=s[t]*r,s[t]=e,e>>=8;for(;e;)s[i++]=e,e>>=8}for(let r=0;r<n&&e[r]===t.chars[0];r++)i++;return s.subarray(0,i).reverse()}encode(e){let{table:t}=this,r=t.chars.length,n=[];for(let t of e){for(let e=0;e<n.length;++e){let s=n[e]<<8|t;n[e]=s%r,t=s/r|0}for(;t;)n.push(t%r),t=t/r|0}for(let t=0;t<e.length&&!e[t];t++)n.push(0);return t.encode(n.reverse())}}const l=new h("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),d=[996825010,642813549,513874426,1027748829,705979059];function f(e){let t=1;for(let r of e){let e=t>>25;t=(33554431&t)<<5^r;for(let r=0;r<5;r++)e>>r&1&&(t^=d[r])}return t}function u(e){let t=Array.from(e,(t=>{let r=t.codePointAt(0);if(r<33||r>126)throw new Error(`invalid hrp: ${e}`);return r}));return[...t.map((e=>e>>5)),0,...t.map((e=>31&e))]}class w{constructor(e,t,r=1){this.hrp=e,this.v32=t,this.type=r}toString(){return this.hrp+"1"+l.encode(this.v32)+l.encode(function(e,t,r){let n=f([...u(t),...r,0,0,0,0,0,0])^e;return[25,20,15,10,5,0].map((e=>n>>e&31))}(this.type,this.hrp,this.v32))}static decode(e){let t=e.toLowerCase();if(e!==t&&e!==e.toUpperCase())throw new Error("mixed case");let r=t.lastIndexOf("1");if(r<0)throw new Error("no hrp");if(t.length-r<7)throw new Error("no check");let n=t.slice(0,r),s=Uint8Array.from(t.slice(r+1),(e=>l.indexOf(e)));return new this(n,s.subarray(0,-6),f([...u(n),...s]))}}Object.defineProperty(w,"M",{value:734539939,writable:!1,configurable:!1});const g=new Map;class p{static[Symbol.iterator](){return g.values()}static decode(e){let t=e.codePointAt(0),r=this.for(String.fromCodePoint(t)),n=r.decode(e.slice(t<65536?1:2));return{base:r,data:n}}static for(e){if(e instanceof this)return e;let t=g.get(e);if(!t)throw new Error(`unknown multibase: ${e}`);return t}constructor(e,t){if("string"!=typeof e||1!==e.length)throw new TypeError("invalid prefix");this.prefix=e,this.name=t,g.set(e,this)}encodeWithPrefix(e){return this.prefix+this.encode(e)}}class b{static from(e){"string"==typeof e&&(e=p.decode(e));let t,[r,n]=s(e);if([t,n]=s(e,n),(e=new Uint8Array(e.slice(n))).length!==t)throw new Error(`expected ${t}, got ${e.length} bytes`);return new this(r,e)}constructor(e,t){this.code=e,this.hash=t}get length(){return n(this.code)+n(this.hash.length)+this.hash.length}get bytes(){let e=new Uint8Array(this.length);return this.write(e,0),e}write(e,t){return e.set(this.hash,i(e,this.hash.length,i(e,this.code,t))),t}}function m(e,t,r,n,s=[]){let i=0,o=0,h=(1<<r)-1;for(let n of e){if(n<0||n>>t)throw new Error("invalid digit");for(i=(65535&i)<<t|n,o+=t;o>=r;)o-=r,s.push(i>>o&h)}if(n)o&&s.push(i<<r-o&h);else if(o>=t||i<<r-o&h)throw new Error("malformed");return Uint8Array.from(s)}const y=new a("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),v=new a("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),x=new c("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),E=new c("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),A=new c("0123456789abcdefghijklmnopqrstuvwxyz"),k=new a("ybndrfg8ejkmcpqxot1uwisza345h769"),U=new a("0123456789abcdefghijklmnopqrstuv"),C=new a("abcdefghijklmnopqrstuvwxyz234567"),M=new a("0123456789abcdef"),j=new c("0123456789"),z=new a("01234567"),S=new a("01");class I extends p{constructor(e,t,r,{casing:n,padding:s}={}){super(e,t),this.coder=r,this.casing=n,this.padding=s}decode(e){return void 0!==this.casing&&(e=e.toLowerCase()),this.coder.decode(e)}encode(e){let t=this.coder.encode(e,this.padding);return this.casing&&(t=t.toUpperCase()),t}}new I("0","base2",S),new I("7","base8",z),new I("9","base10",j),new I("f","base16",M,{casing:!1}),new I("F","base16upper",M,{casing:!0}),new I("v","base32hex",U,{casing:!1}),new I("V","base32hexupper",U,{casing:!0}),new I("t","base32hexpad",U,{casing:!1,padding:!0}),new I("T","base32hexpadupper",U,{casing:!0,padding:!0}),new I("b","base32",C,{casing:!1}),new I("B","base32upper",C,{casing:!0}),new I("c","base32pad",C,{casing:!1,padding:!0}),new I("C","base32padupper",C,{casing:!0,padding:!0}),new I("h","base32z",k),new I("k","base36",A,{casing:!1}),new I("K","base36upper",A,{casing:!0}),new I("z","base58btc",x),new I("Z","base58flickr",E),new I("m","base64",y),new I("M","base64pad",y,{padding:!0}),new I("u","base64url",v),new I("U","base64urlpad",v,{padding:!0});class P{static from(e){let t;if("string"==typeof e)if(46==e.length&&e.startsWith("Qm"))e=x.decode(e);else if(({base:t,data:e}=p.decode(e)),18==e[0])throw new Error("CIDv0 cannot be multibase");try{if(18==e[0]){if(32!==e[1])throw new Error("CIDv0 must be SHA2-256");return new q(b.from(e))}let[r,n]=s(e);if(1===r){let r;return[r,n]=s(e,n),new O(r,b.from(e.slice(n)),t)}throw new Error(`unsupported version: ${r}`)}catch(e){throw new Error(`Malformed CID: ${e.message}`)}}upgrade(){return this}}class q extends P{constructor(e){super(),this.hash=e}get version(){return 0}get codec(){return 112}get length(){return this.hash.bytes.length}get bytes(){return this.hash.bytes}upgrade(){return new O(this.codec,this.hash)}toString(){return x.encode(this.bytes)}}class O extends P{constructor(e,t,r){super(),this.codec=e,this.hash=t,this.base=r}get version(){return 1}get length(){return n(this.version)+n(this.codec)+this.hash.length}get bytes(){let e=new Uint8Array(this.length);return this.hash.write(e,i(e,this.codec,i(e,this.version,0))),e}toString(e){return p.for(e||this.base||"b").encodeWithPrefix(this.bytes)}}export{j as Base10,M as Base16,S as Base2,C as Base32,U as Base32Hex,k as Base32Z,A as Base36,x as Base58BTC,E as Base58Flickr,y as Base64,v as Base64URL,z as Base8,w as Bech32,P as CID,q as CIDv0,O as CIDv1,p as Multibase,I as Multibased,b as Multihash,c as Prefix0,a as RFC4648,m as convert,o as uvarint};
