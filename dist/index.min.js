const e=128,t=(()=>{let t=1;for(;Number.isSafeInteger(t*e);)t*=e;return t})();function r(e){if(!Number.isSafeInteger(e)||e<0)throw new TypeError(`invalid uvarint: ${e}`)}function s(t){r(t);let s=1;for(;t>=e;++s)t=Math.floor(t/e);return s}function n(r,s=0){let n=0;for(let i=1;;i*=e){if(s>=r.length)throw new RangeError("buffer overflow");let a=r[s++];if(n+=(127&a)*i,a<e)break;if(i==t)throw new RangeError("uvarint overflow")}return[n,s]}function i(t,s,n=0){for(r(s);!(s<e);)t[n++]=127&s|e,s=Math.floor(s/e);return t[n++]=s,n}var a=Object.freeze({__proto__:null,MAX:t,read:n,sizeof:s,write:i});class h{constructor(e){this.chars=[...e],this.map=new Map(this.chars.map(((e,t)=>[e,t])))}parse(e){let t=this.map.get(e);if(!Number.isInteger(t))throw new TypeError(`invalid digit "${e}"`);return t}format(e){return e.map((e=>this.chars[e])).join("")}}class o{constructor(e){this.table=new h(e);let t=this.table.chars.length;if(this.bits=Math.log2(t),t<2||!Number.isInteger(this.bits))throw new TypeError;this.table.chars.push("=")}decode(e){let{table:t,bits:r}=this,s=e.length,n=0,i=0,a=0;for(;s&&"="==e[s-1];)--s;let h=new Uint8Array(s*r>>3);for(let o=0;o<s;o++)i=i<<r|t.parse(e[o]),a+=r,a>=8&&(h[n++]=i>>(a-=8)&255);if(i<<8-a&255)throw new Error("invalid");return h}encode(e,t){let{table:r,bits:s}=this,n=(1<<s)-1,i=0,a=0,h=[],o=e.length;for(let t=0;t<o;t++)for(i=i<<8|e[t],a+=8;a>=s;)h.push(i>>(a-=s)&n);for(a&&h.push(i<<s-a&n);t&&h.length*s&7;)h.push(n+1);return r.format(h)}}class c{constructor(e){this.table=new h(e)}decode(e){let{table:t}=this,r=t.chars.length,s=e.length,n=new Uint8Array(s),i=0;for(let s of e){let e=t.parse(s);for(let t=0;t<i;t++)e+=n[t]*r,n[t]=e,e>>=8;for(;e;)n[i++]=e,e>>=8}for(let r=0;r<s&&e[r]===t.chars[0];r++)i++;return n.subarray(0,i).reverse()}encode(e){let{table:t}=this,r=t.chars.length,s=[];for(let t of e){for(let e=0;e<s.length;++e){let n=s[e]<<8|t;s[e]=n%r,t=n/r|0}for(;t;)s.push(t%r),t=t/r|0}for(let t=0;t<e.length&&!e[t];t++)s.push(0);return t.format(s.reverse())}}const l=new Map;class u{static[Symbol.iterator](){return l.values()}static decode(e){let t=e.codePointAt(0),r=this.for(String.fromCodePoint(t)),s=r.decode(e.slice(t<65536?1:2));return{base:r,data:s}}static for(e){if(e instanceof this)return e;let t=l.get(e);if(!t)throw new Error(`unknown multibase: ${e}`);return t}constructor(e,t){if("string"!=typeof e||1!==e.length)throw new TypeError("invalid prefix");this.prefix=e,this.name=t,l.set(e,this)}encodeWithPrefix(e){return this.prefix+this.encode(e)}}class d{static from(e){"string"==typeof e&&(e=u.decode(e));let t,[r,s]=n(e);if([t,s]=n(e,s),(e=new Uint8Array(e.slice(s))).length!==t)throw new Error(`expected ${t}, got ${e.length} bytes`);return new this(r,e)}constructor(e,t){this.code=e,this.hash=t}get length(){return s(this.code)+s(this.hash.length)+this.hash.length}get bytes(){let e=new Uint8Array(this.length);return this.write(e,0),e}write(e,t){return e.set(this.hash,i(e,this.hash.length,i(e,this.code,t))),t}}const w=new o("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),g=new o("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),f=new c("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),p=new c("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),b=new c("0123456789abcdefghijklmnopqrstuvwxyz"),m=new o("ybndrfg8ejkmcpqxot1uwisza345h769"),y=new o("0123456789abcdefghijklmnopqrstuv"),v=new o("abcdefghijklmnopqrstuvwxyz234567"),x=new o("0123456789abcdef"),E=new c("0123456789"),k=new o("01234567"),A=new o("01");class M extends u{constructor(e,t,r,{casing:s,padding:n}={}){super(e,t),this.coder=r,this.casing=s,this.padding=n}decode(e){return void 0!==this.casing&&(e=e.toLowerCase()),this.coder.decode(e)}encode(e){let t=this.coder.encode(e,this.padding);return this.casing&&(t=t.toUpperCase()),t}}new M("0","base2",A),new M("7","base8",k),new M("9","base10",E),new M("f","base16",x,{casing:!1}),new M("F","base16upper",x,{casing:!0}),new M("v","base32hex",y,{casing:!1}),new M("V","base32hexupper",y,{casing:!0}),new M("t","base32hexpad",y,{casing:!1,padding:!0}),new M("T","base32hexpadupper",y,{casing:!0,padding:!0}),new M("b","base32",v,{casing:!1}),new M("B","base32upper",v,{casing:!0}),new M("c","base32pad",v,{casing:!1,padding:!0}),new M("C","base32padupper",v,{casing:!0,padding:!0}),new M("h","base32z",m),new M("k","base36",b,{casing:!1}),new M("K","base36upper",b,{casing:!0}),new M("z","base58btc",f),new M("Z","base58flickr",p),new M("m","base64",w),new M("M","base64pad",w,{padding:!0}),new M("u","base64url",g),new M("U","base64urlpad",g,{padding:!0});class z{static from(e){let t;if("string"==typeof e)if(46==e.length&&e.startsWith("Qm"))e=f.decode(e);else if(({base:t,data:e}=u.decode(e)),18==e[0])throw new Error("CIDv0 cannot be multibase");try{if(18==e[0]){if(32!==e[1])throw new Error("CIDv0 must be SHA2-256");return new C(d.from(e))}let[r,s]=n(e);if(1===r){let r;return[r,s]=n(e,s),new S(r,d.from(e.slice(s)),t)}throw new Error(`unsupported version: ${r}`)}catch(e){throw new Error(`Malformed CID: ${e.message}`)}}upgrade(){return this}}class C extends z{constructor(e){super(),this.hash=e}get version(){return 0}get codec(){return 112}get length(){return this.hash.bytes.length}get bytes(){return this.hash.bytes}upgrade(){return new S(this.codec,this.hash)}toString(){return f.encode(this.bytes)}}class S extends z{constructor(e,t,r){super(),this.codec=e,this.hash=t,this.base=r}get version(){return 1}get length(){return s(this.version)+s(this.codec)+this.hash.length}get bytes(){let e=new Uint8Array(this.length);return this.hash.write(e,i(e,this.codec,i(e,this.version,0))),e}toString(e){return u.for(e||this.base||"b").encodeWithPrefix(this.bytes)}}export{E as Base10,x as Base16,A as Base2,v as Base32,y as Base32Hex,m as Base32Z,b as Base36,f as Base58BTC,p as Base58Flickr,w as Base64,g as Base64URL,k as Base8,z as CID,C as CIDv0,S as CIDv1,u as Multibase,M as Multibased,d as Multihash,c as Prefix0,o as RFC4648,a as uvarint};
