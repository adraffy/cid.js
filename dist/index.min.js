const e=128,t=(()=>{let t=1;for(;Number.isSafeInteger(t*e);)t*=e;return t})();function r(e){if(!Number.isSafeInteger(e)||e<0)throw new TypeError(`invalid uvarint: ${e}`)}function n(t){r(t);let n=1;for(;t>=e;++n)t=Math.floor(t/e);return n}function s(r,n=0){let s=0;for(let i=1;;i*=e){if(n>=r.length)throw new RangeError("buffer overflow");let h=r[n++];if(s+=(127&h)*i,h<e)break;if(i==t)throw new RangeError("uvarint overflow")}return[s,n]}function i(t,n,s=0){for(r(n);!(n<e);)t[s++]=127&n|e,n=Math.floor(n/e);return t[s++]=n,s}var h=Object.freeze({__proto__:null,MAX:t,assert:r,read:s,sizeof:n,write:i});class o{constructor(e){let t=[...e];if(t.length!==e.length)throw new TypeError("expected chars");this.chars=e,this.map=new Map(t.map(((e,t)=>[e,t])))}get length(){return this.map.size}parse(e){let t=this.map.get(e);if(!Number.isInteger(t))throw new TypeError(`invalid digit "${e}"`);return t}format(e){return e.map((e=>this.chars[e])).join("")}}class a{constructor(e){if(this.bits=Math.log2(e.length),!Number.isInteger(this.bits))throw new TypeError;this.table=new o(e),this.table.chars+="="}decode(e){let{table:t,bits:r}=this,n=e.length,s=0,i=0,h=0;for(;n&&"="==e[n-1];)--n;let o=new Uint8Array(n*r>>3);for(let a=0;a<n;a++)i=i<<r|t.parse(e[a]),h+=r,h>=8&&(o[s++]=i>>(h-=8)&255);if(i<<8-h&255)throw new Error("invalid");return o}encode(e,t){let{table:r,bits:n}=this,s=(1<<n)-1,i=0,h=0,o=[],a=e.length;for(let t=0;t<a;t++)for(i=i<<8|e[t],h+=8;h>=n;)o.push(i>>(h-=n)&s);for(h&&o.push(i<<n-h&s);t&&o.length*n&7;)o.push(s+1);return r.format(o)}}class c{constructor(e){this.table=new o(e)}decode(e){let{table:t}=this,r=t.length,n=e.length,s=new Uint8Array(n),i=0;for(let n of e){let e=t.parse(n);for(let t=0;t<i;t++)e+=s[t]*r,s[t]=e,e>>=8;for(;e;)s[i++]=e,e>>=8}for(let r=0;r<n&&e[r]===t.chars[0];r++)i++;return s.subarray(0,i).reverse()}encode(e){let{table:t}=this,r=t.length,n=[];for(let t of e){for(let e=0;e<n.length;++e){let s=n[e]<<8|t;n[e]=s%r,t=s/r|0}for(;t;)n.push(t%r),t=t/r|0}for(let t=0;t<e.length&&!e[t];t++)n.push(0);return t.format(n.reverse())}}const l=new Map;class u{static decode(e){return this.for(e[0]).decode(e.slice(1))}static for(e){let t=l.get(e);if(!t)throw new Error(`unknown multibase: ${e}`);return t}constructor(e,t){if("string"!=typeof e||1!==e.length)throw new TypeError("invalid prefix");this.prefix=e,this.name=t,l.set(e,this)}encodeWithPrefix(e){return this.prefix+this.encode(e)}}class g{static from(e){"string"==typeof e&&(e=u.decode(e));let t,[r,n]=s(e);if([t,n]=s(e,n),(e=new Uint8Array(e.slice(n))).length!==t)throw new Error(`expected ${t}, got ${e.length} bytes`);return new this(r,e)}constructor(e,t){this.code=e,this.hash=t}get length(){return n(this.code)+n(this.hash.length)+this.hash.length}get bytes(){let e=new Uint8Array(this.length);return this.write(e,0),e}write(e,t){return e.set(this.hash,i(e,this.hash.length,i(e,this.code,t))),t}toJSON(){return{...this}}}const w=new a("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),d=new a("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),f=new c("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),p=new c("0123456789abcdefghijklmnopqrstuvwxyz"),b=new a("0123456789abcdefghijklmnopqrstuv"),m=new a("abcdefghijklmnopqrstuvwxyz234567"),v=new a("0123456789abcdef"),y=new c("0123456789"),x=new a("01234567"),E=new a("01");class I extends u{constructor(e,t,r,{casing:n,padding:s}={}){super(e,t),this.base=r,this.casing=n,this.padding=s}decode(e){return void 0!==this.casing&&(e=e.toLowerCase()),this.base.decode(e)}encode(e){let t=this.base.encode(e,this.padding);return this.casing&&(t=t.toUpperCase()),t}}new I("0","base2",E),new I("7","base8",x),new I("9","base10",y),new I("f","base16",v,{casing:!1}),new I("F","base16upper",v,{casing:!0}),new I("v","base32hex",b,{casing:!1}),new I("V","base32hexupper",b,{casing:!0}),new I("t","base32hexpad",b,{casing:!1,padding:!0}),new I("T","base32hexpadupper",b,{casing:!0,padding:!0}),new I("b","base32",m,{casing:!1}),new I("B","base32upper",m,{casing:!0}),new I("c","base32pad",m,{casing:!1,padding:!0}),new I("C","base32padupper",m,{casing:!0,padding:!0}),new I("k","base36",p,{casing:!1}),new I("K","base36upper",p,{case:!0}),new I("z","base58btc",f),new I("m","base64",w),new I("M","base64pad",w,{padding:!0}),new I("u","base64url",d),new I("U","base64urlpad",d,{padding:!0}),new I("1","base58btc-Identity",f),new I("Q","base58btc-CIDv0",f);const M=u.for("Q");class k{static from(e){if("string"==typeof e)if(46==e.length&&e.startsWith("Qm"))e=M.decode(e);else if(18==(e=u.decode(e))[0])throw new Error("CIDv0 cannot be multibase");try{if(18==e[0]){if(32!==e[1])throw new Error("CIDv0 must be SHA2-256");return new A(g.from(e))}let[t,r]=s(e);if(1===t){let t;return[t,r]=s(e,r),new C(t,g.from(e.slice(r)))}throw new Error(`unsupported version: ${t}`)}catch(e){throw new Error(`Malformed CID: ${e.message}`)}}upgrade(){return this}toJSON(){let{version:e,codec:t,hash:r}=this;return{version:e,codec:t,hash:r}}}class A extends k{constructor(e){super(),this.hash=e}get version(){return 0}get codec(){return 112}get length(){return this.hash.bytes.length}get bytes(){return this.hash.bytes}upgrade(){return new C(this.codec,this.hash)}toString(){return M.encode(this.bytes)}}class C extends k{constructor(e,t){super(),this.codec=e,this.hash=t}get version(){return 1}get length(){return n(this.version)+n(this.codec)+this.hash.length}get bytes(){let e=new Uint8Array(this.length);return this.hash.write(e,i(e,this.codec,i(e,this.version,0))),e}toString(e){return e||(e=114===this.codec?"k":"b"),e instanceof u||(e=u.for(e)),e.encodeWithPrefix(this.bytes)}}export{y as Base10,v as Base16,E as Base2,m as Base32,b as Base32Hex,p as Base36,f as Base58BTC,w as Base64,d as Base64URL,x as Base8,k as CID,A as CIDv0,C as CIDv1,u as Multibase,I as MultibaseWrapper,g as Multihash,c as Prefix0,a as RFC4648,h as uvarint};
