const e=128,t=(()=>{let t=1;for(;Number.isSafeInteger(t*e);)t*=e;return t})();function r(e){if(!Number.isSafeInteger(e)||e<0)throw new TypeError(`invalid uvarint: ${e}`)}function n(t){r(t);let n=1;for(;t>=e;++n)t=Math.floor(t/e);return n}function s(r,n=0){let s=0;for(let i=1;;i*=e){if(n>=r.length)throw new RangeError("buffer overflow");let h=r[n++];if(s+=(127&h)*i,h<e)break;if(i==t)throw new RangeError("uvarint overflow")}return[s,n]}function i(t,n,s=0){for(r(n);!(n<e);)t[s++]=127&n|e,n=Math.floor(n/e);return t[s++]=n,s}var h=Object.freeze({__proto__:null,MAX:t,read:s,sizeof:n,write:i});class a{constructor(e){this.chars=[...e],this.map=new Map(this.chars.map(((e,t)=>[e,t])))}get length(){return this.map.size}parse(e){let t=this.map.get(e);if(!Number.isInteger(t))throw new TypeError(`invalid digit "${e}"`);return t}format(e){return e.map((e=>this.chars[e])).join("")}}class o{constructor(e){if(this.table=new a(e),this.bits=Math.log2(this.table.length),this.table.length<2||!Number.isInteger(this.bits))throw new TypeError;this.table.chars.push("=")}decode(e){let{table:t,bits:r}=this,n=e.length,s=0,i=0,h=0;for(;n&&"="==e[n-1];)--n;let a=new Uint8Array(n*r>>3);for(let o=0;o<n;o++)i=i<<r|t.parse(e[o]),h+=r,h>=8&&(a[s++]=i>>(h-=8)&255);if(i<<8-h&255)throw new Error("invalid");return a}encode(e,t){let{table:r,bits:n}=this,s=(1<<n)-1,i=0,h=0,a=[],o=e.length;for(let t=0;t<o;t++)for(i=i<<8|e[t],h+=8;h>=n;)a.push(i>>(h-=n)&s);for(h&&a.push(i<<n-h&s);t&&a.length*n&7;)a.push(s+1);return r.format(a)}}class c{constructor(e){this.table=new a(e)}decode(e){let{table:t}=this,r=t.length,n=e.length,s=new Uint8Array(n),i=0;for(let n of e){let e=t.parse(n);for(let t=0;t<i;t++)e+=s[t]*r,s[t]=e,e>>=8;for(;e;)s[i++]=e,e>>=8}for(let r=0;r<n&&e[r]===t.chars[0];r++)i++;return s.subarray(0,i).reverse()}encode(e){let{table:t}=this,r=t.length,n=[];for(let t of e){for(let e=0;e<n.length;++e){let s=n[e]<<8|t;n[e]=s%r,t=s/r|0}for(;t;)n.push(t%r),t=t/r|0}for(let t=0;t<e.length&&!e[t];t++)n.push(0);return t.format(n.reverse())}}const l=new Map;class u{static[Symbol.iterator](){return l.values()}static decode(e){return this.for(e[0]).decode(e.slice(1))}static for(e){let t=l.get(e);if(!t)throw new Error(`unknown multibase: ${e}`);return t}constructor(e,t){if("string"!=typeof e||1!==e.length)throw new TypeError("invalid prefix");this.prefix=e,this.name=t,l.set(e,this)}encodeWithPrefix(e){return this.prefix+this.encode(e)}}class g{static from(e){"string"==typeof e&&(e=u.decode(e));let t,[r,n]=s(e);if([t,n]=s(e,n),(e=new Uint8Array(e.slice(n))).length!==t)throw new Error(`expected ${t}, got ${e.length} bytes`);return new this(r,e)}constructor(e,t){this.code=e,this.hash=t}get length(){return n(this.code)+n(this.hash.length)+this.hash.length}get bytes(){let e=new Uint8Array(this.length);return this.write(e,0),e}write(e,t){return e.set(this.hash,i(e,this.hash.length,i(e,this.code,t))),t}}const w=new o("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),d=new o("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),f=new c("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),p=new c("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),b=new c("0123456789abcdefghijklmnopqrstuvwxyz"),m=new o("ybndrfg8ejkmcpqxot1uwisza345h769"),y=new o("0123456789abcdefghijklmnopqrstuv"),v=new o("abcdefghijklmnopqrstuvwxyz234567"),x=new o("0123456789abcdef"),E=new c("0123456789"),k=new o("01234567"),z=new o("01");class M extends u{constructor(e,t,r,{casing:n,padding:s}={}){super(e,t),this.coder=r,this.casing=n,this.padding=s}decode(e){return void 0!==this.casing&&(e=e.toLowerCase()),this.coder.decode(e)}encode(e){let t=this.coder.encode(e,this.padding);return this.casing&&(t=t.toUpperCase()),t}}new M("0","base2",z),new M("7","base8",k),new M("9","base10",E),new M("f","base16",x,{casing:!1}),new M("F","base16upper",x,{casing:!0}),new M("v","base32hex",y,{casing:!1}),new M("V","base32hexupper",y,{casing:!0}),new M("t","base32hexpad",y,{casing:!1,padding:!0}),new M("T","base32hexpadupper",y,{casing:!0,padding:!0}),new M("b","base32",v,{casing:!1}),new M("B","base32upper",v,{casing:!0}),new M("c","base32pad",v,{casing:!1,padding:!0}),new M("C","base32padupper",v,{casing:!0,padding:!0}),new M("h","base32z",m),new M("k","base36",b,{casing:!1}),new M("K","base36upper",b,{casing:!0}),new M("z","base58btc",f),new M("Z","base58flickr",p),new M("m","base64",w),new M("M","base64pad",w,{padding:!0}),new M("u","base64url",d),new M("U","base64urlpad",d,{padding:!0});const A=u.for("b");class U{static from(e){if("string"==typeof e)if(46==e.length&&e.startsWith("Qm"))e=f.decode(e);else if(18==(e=u.decode(e))[0])throw new Error("CIDv0 cannot be multibase");try{if(18==e[0]){if(32!==e[1])throw new Error("CIDv0 must be SHA2-256");return new j(g.from(e))}let[t,r]=s(e);if(1===t){let t;return[t,r]=s(e,r),new C(t,g.from(e.slice(r)))}throw new Error(`unsupported version: ${t}`)}catch(e){throw new Error(`Malformed CID: ${e.message}`)}}upgrade(){return this}}class j extends U{constructor(e){super(),this.hash=e}get version(){return 0}get codec(){return 112}get length(){return this.hash.bytes.length}get bytes(){return this.hash.bytes}upgrade(){return new C(this.codec,this.hash)}toString(){return f.encode(this.bytes)}}class C extends U{constructor(e,t){super(),this.codec=e,this.hash=t}get version(){return 1}get length(){return n(this.version)+n(this.codec)+this.hash.length}get bytes(){let e=new Uint8Array(this.length);return this.hash.write(e,i(e,this.codec,i(e,this.version,0))),e}toString(e){return e||(e=114===this.codec?"k":A),e instanceof u||(e=u.for(e)),e.encodeWithPrefix(this.bytes)}}export{E as Base10,x as Base16,z as Base2,v as Base32,y as Base32Hex,m as Base32Z,b as Base36,f as Base58BTC,p as Base58Flickr,w as Base64,d as Base64URL,k as Base8,U as CID,j as CIDv0,C as CIDv1,u as Multibase,M as MultibaseWrapper,g as Multihash,c as Prefix0,o as RFC4648,h as uvarint};
